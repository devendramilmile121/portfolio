import{r as d,j as R}from"./vendor-react-gM1mPWB3.js";import{u as M}from"./vendor--radix-ui-react-compose-refs-DBaD7hpW.js";import{P as _}from"./vendor--radix-ui-react-primitive-BKAPG_6T.js";import{u as y}from"./vendor--radix-ui-react-use-callback-ref-BdE_WETI.js";var F="focusScope.autoFocusOnMount",T="focusScope.autoFocusOnUnmount",N={bubbles:!1,cancelable:!0},x="FocusScope",K=d.forwardRef((e,t)=>{const{loop:n=!1,trapped:u=!1,onMountAutoFocus:p,onUnmountAutoFocus:L,...g}=e,[s,P]=d.useState(null),E=y(p),v=y(L),b=d.useRef(null),U=M(t,o=>P(o)),a=d.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;d.useEffect(()=>{if(u){let o=function(i){if(a.paused||!s)return;const c=i.target;s.contains(c)?b.current=c:f(b.current,{select:!0})},l=function(i){if(a.paused||!s)return;const c=i.relatedTarget;c!==null&&(s.contains(c)||f(b.current,{select:!0}))},r=function(i){if(document.activeElement===document.body)for(const h of i)h.removedNodes.length>0&&f(s)};document.addEventListener("focusin",o),document.addEventListener("focusout",l);const m=new MutationObserver(r);return s&&m.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",o),document.removeEventListener("focusout",l),m.disconnect()}}},[u,s,a.paused]),d.useEffect(()=>{if(s){O.add(a);const o=document.activeElement;if(!s.contains(o)){const r=new CustomEvent(F,N);s.addEventListener(F,E),s.dispatchEvent(r),r.defaultPrevented||(k(V(I(s)),{select:!0}),document.activeElement===o&&f(s))}return()=>{s.removeEventListener(F,E),setTimeout(()=>{const r=new CustomEvent(T,N);s.addEventListener(T,v),s.dispatchEvent(r),r.defaultPrevented||f(o??document.body,{select:!0}),s.removeEventListener(T,v),O.remove(a)},0)}}},[s,E,v,a]);const A=d.useCallback(o=>{if(!n&&!u||a.paused)return;const l=o.key==="Tab"&&!o.altKey&&!o.ctrlKey&&!o.metaKey,r=document.activeElement;if(l&&r){const m=o.currentTarget,[i,c]=w(m);i&&c?!o.shiftKey&&r===c?(o.preventDefault(),n&&f(i,{select:!0})):o.shiftKey&&r===i&&(o.preventDefault(),n&&f(c,{select:!0})):r===m&&o.preventDefault()}},[n,u,a.paused]);return R.jsx(_.div,{tabIndex:-1,...g,ref:U,onKeyDown:A})});K.displayName=x;function k(e,{select:t=!1}={}){const n=document.activeElement;for(const u of e)if(f(u,{select:t}),document.activeElement!==n)return}function w(e){const t=I(e),n=S(t,e),u=S(t.reverse(),e);return[n,u]}function I(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:u=>{const p=u.tagName==="INPUT"&&u.type==="hidden";return u.disabled||u.hidden||p?NodeFilter.FILTER_SKIP:u.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function S(e,t){for(const n of e)if(!D(n,{upTo:t}))return n}function D(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function H(e){return e instanceof HTMLInputElement&&"select"in e}function f(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&H(e)&&t&&e.select()}}var O=j();function j(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=C(e,t),e.unshift(t)},remove(t){e=C(e,t),e[0]?.resume()}}}function C(e,t){const n=[...e],u=n.indexOf(t);return u!==-1&&n.splice(u,1),n}function V(e){return e.filter(t=>t.tagName!=="A")}export{K as F};
